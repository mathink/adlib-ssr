<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Adlibssr.btree</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Adlibssr.btree</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab1"></a><h1 class="section">Binary tree on Coq with SSReflect</h1>

 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.ssreflect</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.ssrfun</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.ssrbool</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.eqtype</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.seq</span><br/>
&nbsp;&nbsp;<span class="id" type="library">Ssreflect.ssrnat</span>.<br/>

<br/>
<span class="id" type="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" type="keyword">Unset</span> <span class="id" type="keyword">Strict</span> <span class="id" type="keyword">Implicit</span>.<br/>
<span class="id" type="keyword">Unset</span> <span class="id" type="keyword">Printing</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Defensive</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab2"></a><h2 class="section">Definitions of Type of Binary-tree</h2>

</div>
<div class="code">
<span class="id" type="keyword">Inductive</span> <a name="btree"><span class="id" type="inductive">btree</span></a> (<span class="id" type="var">T</span>: <span class="id" type="keyword">Type</span>) :=<br/>
| <a name="bleaf"><span class="id" type="constructor">bleaf</span></a><br/>
| <a name="bnode"><span class="id" type="constructor">bnode</span></a> (<span class="id" type="var">x</span>: <span class="id" type="var">T</span>)(<span class="id" type="var">tl</span> <span class="id" type="var">tr</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <span class="id" type="var">T</span>).<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#bleaf"><span class="id" type="constructor">bleaf</span></a> {<span class="id" type="var">T</span>}.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#bnode"><span class="id" type="constructor">bnode</span></a> {<span class="id" type="var">T</span>}(<span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>).<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="::'#'"><span class="id" type="notation">"</span></a>#" := <a class="idref" href="Adlibssr.btree.html#bleaf"><span class="id" type="constructor">bleaf</span></a>.<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'-<'_x_'>-'_x"><span class="id" type="notation">"</span></a>tl -&lt; x &gt;- tr" := (<a class="idref" href="Adlibssr.btree.html#bnode"><span class="id" type="constructor">bnode</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 65, <span class="id" type="keyword">no</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="BinaryTree"><span class="id" type="section">BinaryTree</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> (<a name="BinaryTree.T"><span class="id" type="variable">T</span></a>: <span class="id" type="keyword">Type</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Implicit</span> <span class="id" type="keyword">Type</span> (<span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="size"><span class="id" type="definition">size</span></a> <span class="id" type="var">t</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">+</span> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <span class="id" type="var">tr</span><span class="id" type="notation">).+1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="size0bleaf"><span class="id" type="lemma">size0bleaf</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0 -&gt; <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="bleafSp"><span class="id" type="definition">bleafSp</span></a> <span class="id" type="var">t</span> := <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="bleafSP"><span class="id" type="lemma">bleafSP</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>) (<a class="idref" href="Adlibssr.btree.html#bleafSp"><span class="id" type="definition">bleafSp</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">t</span>; <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="height"><span class="id" type="definition">height</span></a> <span class="id" type="var">t</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">let</span> <span class="id" type="var">hl</span> := <a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <span class="id" type="var">tl</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">hr</span> := <a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <span class="id" type="var">tr</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><span class="id" type="definition">maxn</span> <a class="idref" href="Adlibssr.btree.html#hl"><span class="id" type="variable">hl</span></a> <a class="idref" href="Adlibssr.btree.html#hr"><span class="id" type="variable">hr</span></a><span class="id" type="notation">).+1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="height0bleaf"><span class="id" type="lemma">height0bleaf</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0 -&gt; <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="bleafHp"><span class="id" type="definition">bleafHp</span></a> <span class="id" type="var">t</span> := <a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="bleafHP"><span class="id" type="lemma">bleafHP</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>) (<a class="idref" href="Adlibssr.btree.html#bleafHp"><span class="id" type="definition">bleafHp</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">t</span>; <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="bleafSH"><span class="id" type="lemma">bleafSH</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#bleafSp"><span class="id" type="definition">bleafSp</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#bleafHp"><span class="id" type="definition">bleafHp</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="revtree"><span class="id" type="definition">revtree</span></a> <span class="id" type="var">t</span> : <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <span class="id" type="var">tr</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <span class="id" type="var">tl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="revtree_idempotent"><span class="id" type="lemma">revtree_idempotent</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [| <span class="id" type="var">x</span> /= <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt;].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="revtree_size"><span class="id" type="lemma">revtree_size</span></a> <span class="id" type="var">t</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">_</span> /= <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt;]; <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">addnC</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="revtree_height"><span class="id" type="lemma">revtree_height</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">_</span> /= <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt; ]; <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">maxnC</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">t</span> : <span class="id" type="abbreviation">seq</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">++</span> <span class="id" type="notation">[::</span> <span class="id" type="var">x</span> <span class="id" type="notation">&amp;</span> <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tr</span> <span class="id" type="notation">]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="notation">[::]</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_size"><span class="id" type="lemma">flatten_size</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">seq.size</span> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">x</span> /= <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">seq.size_cat</span> /= <span class="id" type="lemma">addnS</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_rev"><span class="id" type="lemma">flatten_rev</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">rev</span> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">x</span> /= <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">rev_cat</span> <span class="id" type="lemma">rev_cons</span> <span class="id" type="lemma">cat_rcons</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="flatten_m"><span class="id" type="definition">flatten_m</span></a> <span class="id" type="var">t</span> : <span class="id" type="abbreviation">seq</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="notation">[::</span> <span class="id" type="var">x</span> <span class="id" type="notation">&amp;</span> <a class="idref" href="Adlibssr.btree.html#flatten_m"><span class="id" type="definition">flatten_m</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">++</span> <a class="idref" href="Adlibssr.btree.html#flatten_m"><span class="id" type="definition">flatten_m</span></a> <span class="id" type="var">tr</span> <span class="id" type="notation">]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="notation">[::]</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="flatten_r"><span class="id" type="definition">flatten_r</span></a> <span class="id" type="var">t</span> : <span class="id" type="abbreviation">seq</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#flatten_r"><span class="id" type="definition">flatten_r</span></a> <span class="id" type="var">tr</span> <span class="id" type="notation">++</span> <span class="id" type="notation">[::</span> <span class="id" type="var">x</span> <span class="id" type="notation">&amp;</span> <a class="idref" href="Adlibssr.btree.html#flatten_r"><span class="id" type="definition">flatten_r</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="notation">[::]</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="flatten_l"><span class="id" type="definition">flatten_l</span></a> := <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_lr"><span class="id" type="lemma">flatten_lr</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">rev</span> (<a class="idref" href="Adlibssr.btree.html#flatten_l"><span class="id" type="definition">flatten_l</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#flatten_r"><span class="id" type="definition">flatten_r</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">x</span> /= <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">rev_cat</span> <span class="id" type="lemma">rev_cons</span> <span class="id" type="lemma">cat_rcons</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="BinaryTree.BtreePred"><span class="id" type="section">BtreePred</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> (<a name="BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a>: <span class="id" type="definition">pred</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="count"><span class="id" type="definition">count</span></a> <span class="id" type="var">t</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">let</span>: <span class="id" type="var">cl</span> := <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <span class="id" type="var">tl</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span>: <span class="id" type="var">cr</span> := <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <span class="id" type="var">tr</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span> <span class="id" type="notation">+</span> <span class="id" type="var">cl</span> <span class="id" type="notation">+</span> <span class="id" type="var">cr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> 0.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_count"><span class="id" type="lemma">flatten_count</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">seq.count</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">count_cat</span> /= <span class="id" type="lemma">addnCA</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">addnA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="has"><span class="id" type="definition">has</span></a> <span class="id" type="var">t</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <span class="id" type="var">tl</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <span class="id" type="var">tr</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_has"><span class="id" type="lemma">flatten_has</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">seq.has</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">has_cat</span> /= <span class="id" type="lemma">orbCA</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">orbA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="has_bleaf"><span class="id" type="lemma">has_bleaf</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="has_bnode1"><span class="id" type="lemma">has_bnode1</span></a> <span class="id" type="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> (<a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a><a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= 2!<span class="id" type="lemma">orbF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="all"><span class="id" type="definition">all</span></a> <span class="id" type="var">t</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <span class="id" type="var">tl</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="flatten_all"><span class="id" type="lemma">flatten_all</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">seq.all</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">all_cat</span> /= <span class="id" type="lemma">andbCA</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">andbA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="all_bleaf"><span class="id" type="lemma">all_bleaf</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="all_bnode1"><span class="id" type="lemma">all_bnode1</span></a> <span class="id" type="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> (<a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a><a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= 2!<span class="id" type="lemma">andbT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="has_count"><span class="id" type="lemma">has_count</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a>0 <span class="id" type="notation">&lt;</span> <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> 2!<span class="id" type="lemma">addn_gt0</span> -<span class="id" type="var">IHl</span> -<span class="id" type="var">IHr</span> <span class="id" type="lemma">lt0b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="count_size"><span class="id" type="lemma">count_size</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">&lt;=</span> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">addn1</span> -<span class="id" type="lemma">addnA</span> [<span class="id" type="var">_</span> <span class="id" type="notation">+</span> 1]<span class="id" type="lemma">addnC</span>; <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">leq_add</span> (<span class="id" type="lemma">leq_b1</span> <span class="id" type="var">_</span>) (<span class="id" type="lemma">leq_add</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="leq_add_eq"><span class="id" type="lemma">leq_add_eq</span></a> <span class="id" type="var">m1</span> <span class="id" type="var">m2</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#m1"><span class="id" type="variable">m1</span></a> <span class="id" type="notation">&lt;=</span> <a class="idref" href="Adlibssr.btree.html#n1"><span class="id" type="variable">n1</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#m2"><span class="id" type="variable">m2</span></a> <span class="id" type="notation">&lt;=</span> <a class="idref" href="Adlibssr.btree.html#n2"><span class="id" type="variable">n2</span></a> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#m1"><span class="id" type="variable">m1</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#n1"><span class="id" type="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#m2"><span class="id" type="variable">m2</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#n2"><span class="id" type="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#m1"><span class="id" type="variable">m1</span></a> <span class="id" type="notation">+</span> <a class="idref" href="Adlibssr.btree.html#m2"><span class="id" type="variable">m2</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#n1"><span class="id" type="variable">n1</span></a> <span class="id" type="notation">+</span> <a class="idref" href="Adlibssr.btree.html#n2"><span class="id" type="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">leq_eqVlt</span>; <span class="id" type="tactic">move</span>=&gt; /<span class="id" type="lemma">orP</span> [/<span class="id" type="lemma">eqP</span> -&gt; /=|]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">eqn_add2l</span> <span class="id" type="lemma">eq_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Hlt</span> <span class="id" type="var">Hle</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">m1</span> <span class="id" type="notation">==</span> <span class="id" type="var">n1</span>]<span class="id" type="lemma">eq_sym</span> (<span class="id" type="lemma">gtn_eqF</span> <span class="id" type="var">Hlt</span>) /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">have</span> <span class="id" type="var">H</span>: <span class="id" type="var">m1</span> <span class="id" type="notation">+</span> <span class="id" type="var">m2</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">n1</span> <span class="id" type="notation">+</span> <span class="id" type="var">n2</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">_</span> <span class="id" type="notation">==</span> <span class="id" type="var">_</span>]<span class="id" type="lemma">eq_sym</span> (<span class="id" type="lemma">gtn_eqF</span> <span class="id" type="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="lemma">leq_ltn_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">m1</span> <span class="id" type="notation">+</span> <span class="id" type="var">n2</span>); <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">leq_add2l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">ltn_add2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="all_count"><span class="id" type="lemma">all_count</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">addn1</span> -<span class="id" type="lemma">addnA</span> [<span class="id" type="var">_</span> <span class="id" type="notation">+</span> 1]<span class="id" type="lemma">addnC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span>) =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">eqn_add2l</span> <a class="idref" href="Adlibssr.btree.html#leq_add_eq"><span class="id" type="lemma">leq_add_eq</span></a>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">apply</span> <a class="idref" href="Adlibssr.btree.html#count_size"><span class="id" type="lemma">count_size</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">add0n</span> <span class="id" type="lemma">add1n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">have</span> <span class="id" type="var">Hlt</span>: (<a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">+</span> <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <span class="id" type="var">tr</span> <span class="id" type="notation">&lt;</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <span class="id" type="var">tl</span> <span class="id" type="notation">+</span> <a class="idref" href="Adlibssr.btree.html#size"><span class="id" type="definition">size</span></a> <span class="id" type="var">tr</span><span class="id" type="notation">).+1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">last</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">_</span> <span class="id" type="notation">==</span> <span class="id" type="var">_</span>]<span class="id" type="lemma">eq_sym</span> (<span class="id" type="lemma">gtn_eqF</span> <span class="id" type="var">Hlt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">ltnS</span>; <span class="id" type="tactic">apply</span> <span class="id" type="lemma">leq_add</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Adlibssr.btree.html#count_size"><span class="id" type="lemma">count_size</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree.BtreePred"><span class="id" type="section">BtreePred</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_count"><span class="id" type="lemma">eq_count</span></a> <span class="id" type="var">p1</span> <span class="id" type="var">p2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span>; <span class="id" type="tactic">elim</span>=&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_has"><span class="id" type="lemma">eq_has</span></a> <span class="id" type="var">p1</span> <span class="id" type="var">p2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span>; <span class="id" type="tactic">elim</span>=&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_all"><span class="id" type="lemma">eq_all</span></a> <span class="id" type="var">p1</span> <span class="id" type="var">p2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#p2"><span class="id" type="variable">p2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span>; <span class="id" type="tactic">elim</span>=&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> -&gt; <span class="id" type="var">tr</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="path"><span class="id" type="inductive">path</span></a> :=<br/>
&nbsp;&nbsp;| <a name="path_here"><span class="id" type="constructor">path_here</span></a><br/>
&nbsp;&nbsp;| <a name="path_left"><span class="id" type="constructor">path_left</span></a> <span class="id" type="var">of</span> <a class="idref" href="Adlibssr.btree.html#path"><span class="id" type="inductive">path</span></a><br/>
&nbsp;&nbsp;| <a name="path_right"><span class="id" type="constructor">path_right</span></a> <span class="id" type="var">of</span> <a class="idref" href="Adlibssr.btree.html#path"><span class="id" type="inductive">path</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="BinaryTree.::'><'"><span class="id" type="notation">"</span></a>&gt;&lt;" := <a class="idref" href="Adlibssr.btree.html#path_here"><span class="id" type="constructor">path_here</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="BinaryTree.::'<<'_x"><span class="id" type="notation">"</span></a>&lt;&lt; p" := (<a class="idref" href="Adlibssr.btree.html#path_left"><span class="id" type="constructor">path_left</span></a> <span class="id" type="var">p</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 45, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="BinaryTree.::'>>'_x"><span class="id" type="notation">"</span></a>&gt;&gt; p" := (<a class="idref" href="Adlibssr.btree.html#path_right"><span class="id" type="constructor">path_right</span></a> <span class="id" type="var">p</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 45, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Implicit</span> <span class="id" type="keyword">Type</span> (<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#path"><span class="id" type="inductive">path</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="length"><span class="id" type="definition">length</span></a> <span class="id" type="var">p</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'><'"><span class="id" type="notation">&gt;&lt;</span></a> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'<<'_x"><span class="id" type="notation">&lt;&lt;</span></a> <span class="id" type="var">p'</span> | <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'>>'_x"><span class="id" type="notation">&gt;&gt;</span></a> <span class="id" type="var">p'</span> =&gt; <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#length"><span class="id" type="definition">length</span></a> <span class="id" type="var">p'</span><span class="id" type="notation">).+1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="traverse"><span class="id" type="definition">traverse</span></a> <span class="id" type="var">p</span> <span class="id" type="var">t</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> <a class="idref" href="Adlibssr.btree.html#BinaryTree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">match</span> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'><'"><span class="id" type="notation">&gt;&lt;</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'<<'_x"><span class="id" type="notation">&lt;&lt;</span></a> <span class="id" type="var">p'</span> =&gt; <a class="idref" href="Adlibssr.btree.html#traverse"><span class="id" type="definition">traverse</span></a> <span class="id" type="var">p'</span> <span class="id" type="var">tl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#BinaryTree.::'>>'_x"><span class="id" type="notation">&gt;&gt;</span></a> <span class="id" type="var">p'</span> =&gt; <a class="idref" href="Adlibssr.btree.html#traverse"><span class="id" type="definition">traverse</span></a> <span class="id" type="var">p'</span> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="traverse_height"><span class="id" type="lemma">traverse_height</span></a> <span class="id" type="var">p</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#height"><span class="id" type="definition">height</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">&lt;</span> <a class="idref" href="Adlibssr.btree.html#length"><span class="id" type="definition">length</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#traverse"><span class="id" type="definition">traverse</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">elim</span>: <span class="id" type="var">p</span> <span class="id" type="var">t</span> =&gt; [//= | <span class="id" type="var">p</span> <span class="id" type="var">IHp</span> | <span class="id" type="var">p</span> <span class="id" type="var">IHp</span>] [//= | <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>] /=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">ltnS</span> <span class="id" type="lemma">gtn_max</span>; <span class="id" type="tactic">move</span>=&gt; /<span class="id" type="lemma">andP</span> [<span class="id" type="var">Hltl</span> <span class="id" type="var">Hltr</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">IHp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Adlibssr.btree.html#BinaryTree"><span class="id" type="section">BinaryTree</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#bleafSP"><span class="id" type="lemma">bleafSP</span></a> {<span class="id" type="var">T</span> <span class="id" type="var">t</span>}.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#bleafHP"><span class="id" type="lemma">bleafHP</span></a> {<span class="id" type="var">T</span> <span class="id" type="var">t</span>}.<br/>

<br/>
<span class="id" type="var">Prenex</span> <span class="id" type="var">Implicits</span> <span class="id" type="var">size</span> <span class="id" type="var">bleafSP</span> <span class="id" type="var">bleafHP</span> <span class="id" type="var">revtree</span> <span class="id" type="var">flatten</span> <span class="id" type="var">traverse</span>.<br/>
<span class="id" type="var">Prenex</span> <span class="id" type="var">Implicits</span> <span class="id" type="var">count</span> <span class="id" type="var">all</span> <span class="id" type="var">has</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<a name="lab3"></a><h2 class="section">Constructing Instanse of eqtype for <span class="inlinecode"><span class="id" type="var">btree</span></span></h2>

 
</div>
<div class="code">
<span class="id" type="keyword">Section</span> <a name="EqBtree"><span class="id" type="section">EqBtree</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> (<a name="EqBtree.T"><span class="id" type="variable">T</span></a>: <span class="id" type="abbreviation">eqType</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Implicit</span> <span class="id" type="keyword">Type</span> <span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="eqbtree"><span class="id" type="definition">eqbtree</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a>, <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>, <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tl1</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x1</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr1</span>, <span class="id" type="var">tl2</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x2</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">x1</span> <span class="id" type="notation">==</span> <span class="id" type="var">x2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#eqbtree"><span class="id" type="definition">eqbtree</span></a> <span class="id" type="var">tl1</span> <span class="id" type="var">tl2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#eqbtree"><span class="id" type="definition">eqbtree</span></a> <span class="id" type="var">tr1</span> <span class="id" type="var">tr2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eqbtreeP"><span class="id" type="lemma">eqbtreeP</span></a>: <span class="id" type="definition">Equality.axiom</span> <a class="idref" href="Adlibssr.btree.html#eqbtree"><span class="id" type="definition">eqbtree</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> /<span class="id" type="definition">Equality.axiom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>=&gt; [| <span class="id" type="var">x1</span> <span class="id" type="var">tl1</span> <span class="id" type="var">IHl1</span> <span class="id" type="var">tr1</span> <span class="id" type="var">IHr1</span>] [| <span class="id" type="var">x2</span> <span class="id" type="var">tl2</span> <span class="id" type="var">tr2</span>] /=; <span class="id" type="tactic">try</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">x1</span> <span class="id" type="notation">=</span><span class="id" type="notation">P</span> <span class="id" type="var">x2</span>) =&gt; [&lt;- | <span class="id" type="var">Hneqx</span>] /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">case</span>: (<span class="id" type="var">IHl1</span> <span class="id" type="var">tl2</span>) =&gt; [&lt;- | <span class="id" type="var">Hneql</span>] /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">case</span>: (<span class="id" type="var">IHr1</span> <span class="id" type="var">tr2</span>) =&gt; [&lt;- | <span class="id" type="var">Hneqr</span>] /=; <span class="id" type="tactic">try</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">Heqr</span>]; <span class="id" type="tactic">apply</span>: <span class="id" type="var">Hneqr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">Heql</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hneql</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">Heqx</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hneqx</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Canonical</span> <span class="id" type="var">btree_eqMixin</span> := <span class="id" type="abbreviation">EqMixin</span> <a class="idref" href="Adlibssr.btree.html#eqbtreeP"><span class="id" type="lemma">eqbtreeP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Canonical</span> <span class="id" type="var">btree_eqType</span> := <span class="id" type="keyword">Eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="abbreviation">EqType</span> (<a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>) <a class="idref" href="Adlibssr.btree.html#btree_eqMixin"><span class="id" type="definition">btree_eqMixin</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eqbtreeE"><span class="id" type="lemma">eqbtreeE</span></a>: <a class="idref" href="Adlibssr.btree.html#eqbtree"><span class="id" type="definition">eqbtree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="definition">eq_op</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eqbtree_btnode"><span class="id" type="lemma">eqbtree_btnode</span></a> <span class="id" type="var">x1</span> <span class="id" type="var">x2</span> <span class="id" type="var">tl1</span> <span class="id" type="var">tl2</span> <span class="id" type="var">tr1</span> <span class="id" type="var">tr2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#tl1"><span class="id" type="variable">tl1</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x1"><span class="id" type="variable">x1</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr1"><span class="id" type="variable">tr1</span></a><span class="id" type="notation">)</span> <span class="id" type="notation">==</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#tl2"><span class="id" type="variable">tl2</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x2"><span class="id" type="variable">x2</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr2"><span class="id" type="variable">tr2</span></a><span class="id" type="notation">)</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#x1"><span class="id" type="variable">x1</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#x2"><span class="id" type="variable">x2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#tl1"><span class="id" type="variable">tl1</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#tl2"><span class="id" type="variable">tl2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#tr1"><span class="id" type="variable">tr1</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#tr2"><span class="id" type="variable">tr2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="mem_btree"><span class="id" type="definition">mem_btree</span></a> (<span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>): <span class="id" type="definition">pred</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="abbreviation">xpredU1</span> <span class="id" type="var">x</span> (<span class="id" type="abbreviation">xpredU</span> (<a class="idref" href="Adlibssr.btree.html#mem_btree"><span class="id" type="definition">mem_btree</span></a> <span class="id" type="var">tl</span>) (<a class="idref" href="Adlibssr.btree.html#mem_btree"><span class="id" type="definition">mem_btree</span></a> <span class="id" type="var">tr</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="abbreviation">xpred0</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="eqbtree_class"><span class="id" type="definition">eqbtree_class</span></a> := <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Identity</span> <span class="id" type="keyword">Coercion</span> <span class="id" type="var">btree_of_eqbtree</span>: <span class="id" type="var">eqbtree_class</span> &gt;-&gt; <span class="id" type="var">btree</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Coercion</span> <span class="id" type="var">pred_of_eq_btree</span> (<span class="id" type="var">t</span> : <a class="idref" href="Adlibssr.btree.html#eqbtree_class"><span class="id" type="definition">eqbtree_class</span></a>) : <span class="id" type="abbreviation">pred_class</span> := <span class="id" type="notation">[</span><span class="id" type="notation">eta</span> <a class="idref" href="Adlibssr.btree.html#mem_btree"><span class="id" type="definition">mem_btree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">]</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Canonical</span> <span class="id" type="var">btree_predType</span> := @<span class="id" type="definition">mkPredType</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> (<a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>) <a class="idref" href="Adlibssr.btree.html#pred_of_eq_btree"><span class="id" type="definition">pred_of_eq_btree</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Canonical</span> <span class="id" type="var">mem_btree_predType</span> := <span class="id" type="definition">mkPredType</span> <a class="idref" href="Adlibssr.btree.html#mem_btree"><span class="id" type="definition">mem_btree</span></a>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="var">a</span> <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= -<span class="id" type="lemma">orbA</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="in_bleaf"><span class="id" type="lemma">in_bleaf</span></a> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_bnode1"><span class="id" type="lemma">mem_bnode1</span></a> <span class="id" type="var">a</span> <span class="id" type="var">x</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a><a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> /= 2!<span class="id" type="lemma">orbF</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Let</span> <a name="EqBtree.inE"><span class="id" type="variable">inE</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#mem_bnode1"><span class="id" type="lemma">mem_bnode1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <span class="id" type="definition">inE</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_root"><span class="id" type="lemma">mem_root</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span>: <span class="id" type="lemma">predU1l</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="EqBtree.Preds"><span class="id" type="section">Preds</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Variable</span> (<a name="EqBtree.Preds.p"><span class="id" type="variable">p</span></a>: <span class="id" type="definition">pred</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="hasP"><span class="id" type="lemma">hasP</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">exists2</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">,</span></a> <span class="id" type="var">x</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span>) (<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [| /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">Heqpx</span>: (<a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span>) =&gt; /=; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>; <span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#mem_root"><span class="id" type="lemma">mem_root</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">evar</span> (<span class="id" type="var">P</span>:<span class="id" type="keyword">Prop</span>); <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">iffP</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">exact</span>: <span class="id" type="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">orP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>=&gt; [<span class="id" type="var">H</span> | <span class="id" type="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: (<span class="id" type="lemma">elimT</span> <span class="id" type="var">IHl</span> <span class="id" type="var">H</span>) =&gt; [<span class="id" type="var">y</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#EqBtree.inE"><span class="id" type="variable">inE</span></a> ?<span class="id" type="var">Hin</span> 1?<span class="id" type="lemma">orbAC</span> 1?<span class="id" type="lemma">orbC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: (<span class="id" type="lemma">elimT</span> <span class="id" type="var">IHr</span> <span class="id" type="var">H</span>) =&gt; [<span class="id" type="var">y</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#EqBtree.inE"><span class="id" type="variable">inE</span></a> ?<span class="id" type="var">Hin</span> 1?<span class="id" type="lemma">orbC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">unfold</span> <span class="id" type="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">y</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="lemma">orbC</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hin</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">Hin</span> =&gt; /<span class="id" type="lemma">or3P</span> [<span class="id" type="var">Hin</span> | <span class="id" type="var">Heq</span> | <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="lemma">introT</span> <span class="id" type="var">IHr</span>); <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">Heq</span> <span class="id" type="var">Hp</span> =&gt; /<span class="id" type="lemma">eqP</span> -&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heqpx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="lemma">introT</span> <span class="id" type="var">IHl</span>); <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="hasPn"><span class="id" type="lemma">hasPn</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> -&gt; <span class="id" type="notation">~~</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>) (<span class="id" type="notation">~~</span> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span>: (<span class="id" type="lemma">iffP</span> <span class="id" type="lemma">idP</span>) =&gt; [<span class="id" type="var">Hnhas</span> | <span class="id" type="var">Himp</span>] =&gt; [<span class="id" type="var">x</span> <span class="id" type="var">Hin</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">contra</span> <span class="id" type="var">Hnhas</span> =&gt; <span class="id" type="var">Hhas</span>; <span class="id" type="tactic">apply</span> /<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a>; <span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">apply</span> /<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a> =&gt; [[<span class="id" type="var">x</span> <span class="id" type="var">Hin</span>]]; <span class="id" type="tactic">apply</span> /<span class="id" type="lemma">negP</span>; <span class="id" type="tactic">exact</span>: <span class="id" type="var">Himp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="allP"><span class="id" type="lemma">allP</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [| /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">andbA</span> <span class="id" type="lemma">andbC</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">IHl</span> =&gt; /= <span class="id" type="var">IHl</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">right</span>=&gt; <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">case</span>: <span class="id" type="var">IHr</span> =&gt; /= <span class="id" type="var">IHr</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">right</span>=&gt; <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">apply</span>: (<span class="id" type="lemma">iffP</span> <span class="id" type="lemma">idP</span>) =&gt; [<span class="id" type="var">Hp</span> <span class="id" type="var">y</span>|]; <span class="id" type="var">last</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>; <span class="id" type="tactic">exact</span>: <a class="idref" href="Adlibssr.btree.html#mem_root"><span class="id" type="lemma">mem_root</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> /= <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="lemma">orbC</span> <span class="id" type="lemma">orbCA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>/<span class="id" type="lemma">predU1P</span> =&gt; [-&gt; | /<span class="id" type="lemma">orP</span> [<span class="id" type="var">Hy</span>|<span class="id" type="var">Hy</span>]]; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">IHr</span>; <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">y</span> <span class="id" type="var">Hin</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="lemma">orbC</span> <span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>; <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">y</span> <span class="id" type="var">Hin</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="lemma">orbAC</span> <span class="id" type="lemma">orbC</span> <span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="allPn"><span class="id" type="lemma">allPn</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">exists2</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">,</span></a> <span class="id" type="var">x</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists2'_x_','_x_'&'_x"><span class="id" type="notation">&amp;</span></a> <span class="id" type="notation">~~</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <span class="id" type="var">x</span>) (<span class="id" type="notation">~~</span> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds.p"><span class="id" type="variable">p</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>=&gt; [[<span class="id" type="var">x</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">andbC</span> <span class="id" type="lemma">negb_and</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">IHr</span> =&gt; <span class="id" type="var">IHr</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">IHr</span> =&gt; [<span class="id" type="var">y</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hnp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> 1?<span class="id" type="lemma">orbC</span> ?<span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">andbC</span> <span class="id" type="lemma">negb_and</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">IHl</span> =&gt; <span class="id" type="var">IHl</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">IHl</span> =&gt; [<span class="id" type="var">y</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hnp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> 1?<span class="id" type="lemma">orbAC</span> 1?<span class="id" type="lemma">orbC</span> ?<span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">apply</span>: (<span class="id" type="lemma">iffP</span> <span class="id" type="lemma">idP</span>) =&gt; [<span class="id" type="var">Hnp</span> | [<span class="id" type="var">y</span>]]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">rewrite</span> ?<a class="idref" href="Adlibssr.btree.html#mem_root"><span class="id" type="lemma">mem_root</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span>; <span class="id" type="tactic">move</span>=&gt; /<span class="id" type="lemma">or3P</span> [/<span class="id" type="lemma">eqP</span> -&gt; //= | <span class="id" type="var">Hin</span> <span class="id" type="var">Hnp</span> | <span class="id" type="var">Hin</span> <span class="id" type="var">Hnp</span>]; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">negP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">IHl</span>; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">IHr</span>; <span class="id" type="tactic">exists</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.Preds"><span class="id" type="section">Preds</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Section</span> <a name="EqBtree.EqIn"><span class="id" type="section">EqIn</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Variables</span> (<a name="EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a name="EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a>: <span class="id" type="definition">pred</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_in_count"><span class="id" type="lemma">eq_in_count</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">{</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">,</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <span class="id" type="notation">}</span> -&gt; <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heq</span> ?<span class="id" type="var">IHl</span> ?<span class="id" type="var">IHr</span> //=; <span class="id" type="var">last</span> <span class="id" type="tactic">exact</span>: <a class="idref" href="Adlibssr.btree.html#mem_root"><span class="id" type="lemma">mem_root</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">y</span> <span class="id" type="var">Hin</span> /=; <span class="id" type="tactic">apply</span> <span class="id" type="var">Heq</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.inE"><span class="id" type="variable">inE</span></a> <span class="id" type="lemma">orbC</span> <span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">y</span> <span class="id" type="var">Hin</span> /=; <span class="id" type="tactic">apply</span> <span class="id" type="var">Heq</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.inE"><span class="id" type="variable">inE</span></a> <span class="id" type="lemma">orbAC</span> <span class="id" type="lemma">orbC</span> <span class="id" type="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_in_all"><span class="id" type="lemma">eq_in_all</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">{</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">,</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <span class="id" type="notation">}</span> -&gt; <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span> ; <span class="id" type="tactic">rewrite</span> 2!<a class="idref" href="Adlibssr.btree.html#all_count"><span class="id" type="lemma">all_count</span></a> <a class="idref" href="Adlibssr.btree.html#eq_in_count"><span class="id" type="lemma">eq_in_count</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_in_has"><span class="id" type="lemma">eq_in_has</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">{</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">,</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <span class="id" type="notation">}</span> -&gt; <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heq</span> ; <span class="id" type="tactic">rewrite</span> 2!<a class="idref" href="Adlibssr.btree.html#has_count"><span class="id" type="lemma">has_count</span></a> <a class="idref" href="Adlibssr.btree.html#eq_in_count"><span class="id" type="lemma">eq_in_count</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="sub_all"><span class="id" type="lemma">sub_all</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">subpred</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p1"><span class="id" type="variable">p1</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn.p2"><span class="id" type="variable">p2</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Hsub</span>; <span class="id" type="tactic">elim</span>=&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -!<span class="id" type="lemma">andbA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; /<span class="id" type="lemma">and3P</span> [<span class="id" type="var">Hp</span> <span class="id" type="var">Hal</span> <span class="id" type="var">Har</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span>/<span class="id" type="lemma">and3P</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">End</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.EqIn"><span class="id" type="section">EqIn</span></a>.<br/>

<br/>

<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_has_r"><span class="id" type="lemma">eq_has_r</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a> <span class="id" type="notation">=</span><span class="id" type="notation">i</span> <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a><span class="id" type="notation">^~</span> <a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a><span class="id" type="notation">^~</span> <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heqi</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">apply</span>/<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a>/<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span> =&gt; [<span class="id" type="var">x</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">rewrite</span> // ?<span class="id" type="var">Heqi</span> // -?<span class="id" type="var">Heqi</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="eq_all_r"><span class="id" type="lemma">eq_all_r</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a> <span class="id" type="notation">=</span><span class="id" type="notation">i</span> <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a><span class="id" type="notation">^~</span> <a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a> <span class="id" type="notation">=1</span> <a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a><span class="id" type="notation">^~</span> <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Heqi</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">apply</span>/<a class="idref" href="Adlibssr.btree.html#allP"><span class="id" type="lemma">allP</span></a>/<a class="idref" href="Adlibssr.btree.html#allP"><span class="id" type="lemma">allP</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">Hp</span> <span class="id" type="var">x</span> <span class="id" type="var">Hin</span> //; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hp</span>; <span class="id" type="tactic">rewrite</span> // ?<span class="id" type="var">Heqi</span> // -?<span class="id" type="var">Heqi</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="has_sym"><span class="id" type="lemma">has_sym</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> (<span class="id" type="definition">mem</span> <a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a>) <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> (<span class="id" type="definition">mem</span> <a class="idref" href="Adlibssr.btree.html#t2"><span class="id" type="variable">t2</span></a>) <a class="idref" href="Adlibssr.btree.html#t1"><span class="id" type="variable">t1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> /<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a>/<a class="idref" href="Adlibssr.btree.html#hasP"><span class="id" type="lemma">hasP</span></a> =&gt; [] /= [<span class="id" type="var">x</span> <span class="id" type="var">Hin</span> <span class="id" type="var">Hp</span>]; <span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="has_pred1"><span class="id" type="lemma">has_pred1</span></a> <span class="id" type="var">x</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#has"><span class="id" type="definition">has</span></a> (<span class="id" type="definition">pred1</span> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -(<a class="idref" href="Adlibssr.btree.html#eq_has"><span class="id" type="lemma">eq_has</span></a> (<a class="idref" href="Adlibssr.btree.html#mem_bnode1"><span class="id" type="lemma">mem_bnode1</span></a><span class="id" type="notation">^~</span> <span class="id" type="var">x</span>)) -<a class="idref" href="Adlibssr.btree.html#has_sym"><span class="id" type="lemma">has_sym</span></a> /= 2!<span class="id" type="lemma">orbF</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_revtree"><span class="id" type="lemma">mem_revtree</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">=</span><span class="id" type="notation">i</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> 2!<a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">orbAC</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="count_mem"><span class="id" type="abbreviation">count_mem</span></a> <span class="id" type="var">x</span> := (<a class="idref" href="Adlibssr.btree.html#count"><span class="id" type="definition">count</span></a> (<span class="id" type="definition">pred1</span> <span class="id" type="var">x</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="count_memPn"><span class="id" type="lemma">count_memPn</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="inductive">reflect</span> (<a class="idref" href="Adlibssr.btree.html#count_mem"><span class="id" type="abbreviation">count_mem</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0) (<a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="notation">notin</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<a class="idref" href="Adlibssr.btree.html#has_pred1"><span class="id" type="lemma">has_pred1</span></a> <a class="idref" href="Adlibssr.btree.html#has_count"><span class="id" type="lemma">has_count</span></a> -<span class="id" type="lemma">eqn0Ngt</span>; <span class="id" type="tactic">apply</span> <span class="id" type="lemma">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_flatten"><span class="id" type="lemma">mem_flatten</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_cat</span> <span class="id" type="lemma">in_cons</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="lemma">orbCA</span> <span class="id" type="lemma">orbA</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="bleaf_flatten_nil"><span class="id" type="lemma">bleaf_flatten_nil</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> <span class="id" type="notation">[::]</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">t</span> =&gt; //= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl</span>) =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="uniq"><span class="id" type="definition">uniq</span></a> <span class="id" type="var">t</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span> <span class="id" type="notation">\</span><span class="id" type="notation">notin</span> <span class="id" type="var">tl</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#uniq"><span class="id" type="definition">uniq</span></a> <span class="id" type="var">tl</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span> <span class="id" type="notation">\</span><span class="id" type="notation">notin</span> <span class="id" type="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#uniq"><span class="id" type="definition">uniq</span></a> <span class="id" type="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#negb"><span class="id" type="definition">negb</span></a> <span class="id" type="notation">\</span><span class="id" type="notation">o</span> <span class="id" type="definition">mem</span> <span class="id" type="var">tr</span>) <span class="id" type="var">tl</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#all"><span class="id" type="definition">all</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#negb"><span class="id" type="definition">negb</span></a> <span class="id" type="notation">\</span><span class="id" type="notation">o</span> <span class="id" type="definition">mem</span> <span class="id" type="var">tl</span>) <span class="id" type="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="count_uniq_mem"><span class="id" type="lemma">count_uniq_mem</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#uniq"><span class="id" type="definition">uniq</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#count_mem"><span class="id" type="abbreviation">count_mem</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//= | /= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -4!<span class="id" type="lemma">andbA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; /<span class="id" type="lemma">and3P</span> [/<span class="id" type="lemma">negbTE</span> <span class="id" type="var">Hninl</span> /<span class="id" type="var">IHl</span>-&gt;{<span class="id" type="var">IHl</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/<span class="id" type="lemma">and4P</span> [/<span class="id" type="lemma">negbTE</span> <span class="id" type="var">Hninr</span> /<span class="id" type="var">IHr</span>-&gt;{<span class="id" type="var">IHr</span>} <span class="id" type="var">Hrl</span> <span class="id" type="var">Hlr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> [<span class="id" type="var">x</span> <span class="id" type="notation">==</span> <span class="id" type="var">a</span>]<span class="id" type="lemma">eq_sym</span>; <span class="id" type="tactic">case</span>: <span class="id" type="lemma">eqP</span> =&gt; [-&gt; | <span class="id" type="var">Hneq</span>] /=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hninl</span> <span class="id" type="var">Hninr</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">add0n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">Haninl</span>: (<span class="id" type="var">a</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="var">tl</span>) =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Hrl</span> =&gt; /<a class="idref" href="Adlibssr.btree.html#allP"><span class="id" type="lemma">allP</span></a> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">H</span> <span class="id" type="var">a</span> <span class="id" type="var">Haninl</span>) =&gt; /= /<span class="id" type="lemma">negbTE</span> -&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="app_fst"><span class="id" type="definition">app_fst</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">A'</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">f</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#A'"><span class="id" type="variable">A'</span></a>)(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#app_fst"><span class="id" type="definition">app_fst</span></a> <span class="id" type="var">A</span> <span class="id" type="var">A'</span> <span class="id" type="var">B</span> <span class="id" type="var">f</span> / <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="EqBtree.::x_'^1'_x"><span class="id" type="notation">"</span></a>f ^1 p" := (<a class="idref" href="Adlibssr.btree.html#app_fst"><span class="id" type="definition">app_fst</span></a> <span class="id" type="var">f</span> <span class="id" type="var">p</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 3, <span class="id" type="tactic">left</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="app_snd"><span class="id" type="definition">app_snd</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">f</span>: <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#B'"><span class="id" type="variable">B'</span></a>)(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#app_snd"><span class="id" type="definition">app_snd</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span> <span class="id" type="var">f</span> / <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="EqBtree.::x_'^2'_x"><span class="id" type="notation">"</span></a>f ^2 p" := (<a class="idref" href="Adlibssr.btree.html#app_snd"><span class="id" type="definition">app_snd</span></a> <span class="id" type="var">f</span> <span class="id" type="var">p</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 3, <span class="id" type="tactic">left</span> <span class="id" type="keyword">associativity</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="lend"><span class="id" type="definition">lend</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="rend"><span class="id" type="definition">rend</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>: <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_rev_rend"><span class="id" type="lemma">lend_rev_rend</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> ?] <span class="id" type="var">a</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_lend"><span class="id" type="lemma">mem_lend</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> ?] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHl</span> <span class="id" type="var">x</span>) =&gt; /<span class="id" type="lemma">orP</span> [/<span class="id" type="lemma">eqP</span>-&gt; | <span class="id" type="var">Hin</span>]; <span class="id" type="tactic">by</span> [<span class="id" type="tactic">left</span> | <span class="id" type="tactic">right</span>].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_rend"><span class="id" type="lemma">mem_rend</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">==</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> ? <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> <span class="id" type="lemma">orbAC</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHr</span> <span class="id" type="var">x</span>) =&gt; /<span class="id" type="lemma">orP</span> [/<span class="id" type="lemma">eqP</span>-&gt; | <span class="id" type="var">Hin</span>]; <span class="id" type="tactic">by</span> [<span class="id" type="tactic">left</span> | <span class="id" type="tactic">right</span>].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Implicit</span> <span class="id" type="keyword">Type</span> (<span class="id" type="var">s</span>: <span class="id" type="abbreviation">seq</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <a name="rhead"><span class="id" type="abbreviation">rhead</span></a> <span class="id" type="var">s</span> <span class="id" type="var">a</span> := (<span class="id" type="definition">last</span> <span class="id" type="var">a</span> <span class="id" type="var">s</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="rbehead"><span class="id" type="definition">rbehead</span></a> <span class="id" type="var">s</span>: <span class="id" type="abbreviation">seq</span> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">is</span> <span class="id" type="var">x</span> <span class="id" type="notation">::</span> <span class="id" type="var">s'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">if</span> <span class="id" type="var">s'</span> <span class="id" type="var">is</span> <span class="id" type="notation">[::]</span> <span class="id" type="keyword">then</span> <span class="id" type="notation">[::]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="var">x</span> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> <span class="id" type="var">s'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="notation">[::]</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rbehead_cons"><span class="id" type="lemma">rbehead_cons</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">s</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#y"><span class="id" type="variable">y</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#s"><span class="id" type="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">::</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#y"><span class="id" type="variable">y</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#s"><span class="id" type="variable">s</span></a>)<span class="id" type="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rbehead_cat_cons"><span class="id" type="lemma">rbehead_cat_cons</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">x</span> <span class="id" type="var">s2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#s1"><span class="id" type="variable">s1</span></a> <span class="id" type="notation">++</span> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#s1"><span class="id" type="variable">s1</span></a> <span class="id" type="notation">++</span> <a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#s2"><span class="id" type="variable">s2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">x</span> =&gt; [//=|/= <span class="id" type="var">h1</span> <span class="id" type="var">s1</span> <span class="id" type="var">IHs</span>] [| <span class="id" type="var">h2</span> <span class="id" type="var">s2</span>] <span class="id" type="var">x</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">cats0</span>; <span class="id" type="tactic">elim</span>: <span class="id" type="var">s1</span> {<span class="id" type="var">IHs</span>} <span class="id" type="var">h1</span> =&gt; //= <span class="id" type="var">h1'</span> <span class="id" type="var">s1</span> <span class="id" type="var">IH1</span> <span class="id" type="var">h1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">s1</span> {<span class="id" type="var">IHs</span>} <span class="id" type="var">h1</span> =&gt; //= <span class="id" type="var">h1'</span> <span class="id" type="var">s1</span> <span class="id" type="var">IH1</span> <span class="id" type="var">h1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_rbehead"><span class="id" type="lemma">mem_rbehead</span></a> <span class="id" type="var">a</span> <span class="id" type="var">s</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> <a class="idref" href="Adlibssr.btree.html#s"><span class="id" type="variable">s</span></a><span class="id" type="notation">)</span> -&gt; <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#s"><span class="id" type="variable">s</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">s</span> <span class="id" type="var">a</span> =&gt; [//=| <span class="id" type="var">h</span> <span class="id" type="var">s</span> <span class="id" type="var">IHs</span>] <span class="id" type="var">a</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">IHs</span>; <span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> <span class="id" type="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Heql</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">s</span> =&gt; // <span class="id" type="var">h'</span> <span class="id" type="var">s</span> <span class="id" type="var">Heq</span> <span class="id" type="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_cons</span> =&gt; /<span class="id" type="lemma">orP</span> [/<span class="id" type="lemma">eqP</span>-&gt; | <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_cons</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_cons</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="head_cat_cons"><span class="id" type="lemma">head_cat_cons</span></a> <span class="id" type="var">a</span> <span class="id" type="var">x</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">head</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#s1"><span class="id" type="variable">s1</span></a> <span class="id" type="notation">++</span> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="definition">head</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<span class="id" type="definition">rcons</span> <a class="idref" href="Adlibssr.btree.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">s1</span> =&gt; [|] //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_flatten_head"><span class="id" type="lemma">lend_flatten_head</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="definition">head</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#head_cat_cons"><span class="id" type="lemma">head_cat_cons</span></a> <span class="id" type="lemma">headI</span> /= <span class="id" type="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_flatten_rhead"><span class="id" type="lemma">rend_flatten_rhead</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a>  <a class="idref" href="Adlibssr.btree.html#rhead"><span class="id" type="abbreviation">rhead</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">last_cat</span> /= <span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">if</span> <span class="id" type="var">tl</span> <span class="id" type="var">is</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <span class="id" type="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">node</span>, <span class="id" type="var">t'</span>) := <a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#t'"><span class="id" type="variable">t'</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <a name="rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">if</span> <span class="id" type="var">tr</span> <span class="id" type="var">is</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">tl</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">t'</span>, <span class="id" type="var">node</span>) := <a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#t'"><span class="id" type="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="swap"><span class="id" type="definition">swap</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>): <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><span class="id" type="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Arguments</span> <a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> / <span class="id" type="var">p</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="swap_idempotent"><span class="id" type="lemma">swap_idempotent</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> (<a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">p</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="swap_flip"><span class="id" type="lemma">swap_flip</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">q</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <a class="idref" href="Adlibssr.btree.html#q"><span class="id" type="variable">q</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#q"><span class="id" type="variable">q</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; -&gt;; <span class="id" type="tactic">apply</span> <a class="idref" href="Adlibssr.btree.html#swap_idempotent"><span class="id" type="lemma">swap_idempotent</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="swap_app_fst"><span class="id" type="lemma">swap_app_fst</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">A'</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">f</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#A'"><span class="id" type="variable">A'</span></a>)(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a><a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> (<a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">^1</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">^2</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="swap_app_snd"><span class="id" type="lemma">swap_app_snd</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span>: <span class="id" type="keyword">Type</span>}(<span class="id" type="var">f</span>: <a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a> -&gt; <a class="idref" href="Adlibssr.btree.html#B'"><span class="id" type="variable">B'</span></a>)(<span class="id" type="var">p</span>: <a class="idref" href="Adlibssr.btree.html#A"><span class="id" type="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a><a class="idref" href="Adlibssr.btree.html#B"><span class="id" type="variable">B</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> (<a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">^2</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">^1</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> <a class="idref" href="Adlibssr.btree.html#p"><span class="id" type="variable">p</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> [].<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_remove_revtree"><span class="id" type="lemma">lend_remove_revtree</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">^1</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHr</span> =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span> =&gt; /= {<span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">tr</span> <span class="id" type="var">Heqp</span> =&gt; [] //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_remove_revtree"><span class="id" type="lemma">rend_remove_revtree</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#swap"><span class="id" type="definition">swap</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">^2</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -{2}[<span class="id" type="var">t</span>]<a class="idref" href="Adlibssr.btree.html#revtree_idempotent"><span class="id" type="lemma">revtree_idempotent</span></a> <a class="idref" href="Adlibssr.btree.html#swap_app_snd"><span class="id" type="lemma">swap_app_snd</span></a> <a class="idref" href="Adlibssr.btree.html#lend_remove_revtree"><span class="id" type="lemma">lend_remove_revtree</span></a> <a class="idref" href="Adlibssr.btree.html#swap_idempotent"><span class="id" type="lemma">swap_idempotent</span></a> /= <a class="idref" href="Adlibssr.btree.html#revtree_idempotent"><span class="id" type="lemma">revtree_idempotent</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <span class="id" type="var">t</span>) <span class="id" type="var">a</span>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_remove_lend"><span class="id" type="lemma">lend_remove_lend</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">).1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#lend"><span class="id" type="definition">lend</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> ?] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">lrxtl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lrxtl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">IHl</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">tl</span> <span class="id" type="var">Heqlrxtl</span> =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>=&gt; -&gt;.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_remove_rend"><span class="id" type="lemma">rend_remove_rend</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><span class="id" type="notation">).2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#rend"><span class="id" type="definition">rend</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> ? <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">rrxtr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">rrxtr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">IHr</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">tr</span> <span class="id" type="var">Heqrrxtr</span> =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>=&gt; <span class="id" type="var">_</span> -&gt;.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_remove_behead"><span class="id" type="lemma">lend_remove_behead</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">).2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="definition">behead</span> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> ?] <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHl</span> <span class="id" type="var">x</span>) =&gt; {<span class="id" type="var">IHl</span>}; <span class="id" type="tactic">case</span> (<a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span>) =&gt; /= <span class="id" type="var">y</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tl</span> =&gt; //= <span class="id" type="var">z</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr'</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl</span>) =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_remove_head"><span class="id" type="lemma">lend_remove_head</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">).1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="definition">head</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHl</span> <span class="id" type="var">x</span>) =&gt; {<span class="id" type="var">IHl</span>}; <span class="id" type="tactic">case</span> (<a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tl</span>) =&gt; /= <span class="id" type="var">y</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tl</span> =&gt; //= <span class="id" type="var">z</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr'</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl</span>) =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_remove_head_behead"><span class="id" type="lemma">lend_remove_head_behead</span></a> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">^2</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^2'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="definition">head</span> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <span class="id" type="definition">behead</span> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <a class="idref" href="Adlibssr.btree.html#lend_remove_head"><span class="id" type="lemma">lend_remove_head</span></a> <a class="idref" href="Adlibssr.btree.html#lend_remove_behead"><span class="id" type="lemma">lend_remove_behead</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_remove_rhead"><span class="id" type="lemma">rend_remove_rhead</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><span class="id" type="notation">).2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#rhead"><span class="id" type="abbreviation">rhead</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHr</span> <span class="id" type="var">x</span>) =&gt; {<span class="id" type="var">IHr</span>}; <span class="id" type="tactic">case</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span>) =&gt; /= <span class="id" type="var">y</span> <span class="id" type="var">t</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tr</span> =&gt; [/=|/= <span class="id" type="var">z</span> <span class="id" type="var">tl'</span> <span class="id" type="var">tr</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">last_cat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= !<span class="id" type="lemma">last_cat</span> /= !<span class="id" type="lemma">last_cat</span> /=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_remove_rbehead"><span class="id" type="lemma">rend_remove_rbehead</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><span class="id" type="notation">).1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">x</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#rbehead_cat_cons"><span class="id" type="lemma">rbehead_cat_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHr</span> <span class="id" type="var">x</span>) =&gt; {<span class="id" type="var">IHr</span>}; <span class="id" type="tactic">case</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span>) =&gt; /= <span class="id" type="var">y</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tr</span> =&gt; [/=|/= <span class="id" type="var">z</span> <span class="id" type="var">tl'</span> <span class="id" type="var">tr</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">cats0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; -&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl'</span> <span class="id" type="notation">++</span> <span class="id" type="var">z</span> <span class="id" type="notation">::</span> <a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tr</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">l</span> <span class="id" type="var">Heql</span> =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <span class="id" type="var">tl'</span>) =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rend_remove_rhead_rbehead"><span class="id" type="lemma">rend_remove_rhead_rbehead</span></a> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">^1</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="Adlibssr.btree.html#EqBtree.::x_'^1'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#rbehead"><span class="id" type="definition">rbehead</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="Adlibssr.btree.html#rhead"><span class="id" type="abbreviation">rhead</span></a> (<a class="idref" href="Adlibssr.btree.html#flatten"><span class="id" type="definition">flatten</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <a class="idref" href="Adlibssr.btree.html#rend_remove_rhead"><span class="id" type="lemma">rend_remove_rhead</span></a> <a class="idref" href="Adlibssr.btree.html#rend_remove_rbehead"><span class="id" type="lemma">rend_remove_rbehead</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_lend_remove"><span class="id" type="lemma">mem_lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">a</span> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a><span class="id" type="notation">).2</span> -&gt; <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">y</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHl</span> <span class="id" type="var">y</span>) =&gt; {<span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="var">a</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tl</span> =&gt; [//= ? <span class="id" type="var">Hin</span> | <span class="id" type="var">z</span> <span class="id" type="var">tl</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span> <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span> <span class="id" type="lemma">orbCA</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">right</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">y</span> (<span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">z</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">t</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">or3P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Hin</span>; <span class="id" type="tactic">rewrite</span>/= <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span> =&gt; /<span class="id" type="lemma">or3P</span> [/<span class="id" type="lemma">eqP</span>&lt;- | <span class="id" type="var">Hin</span> | <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or32</span>, <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or33</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="mem_rend_remove"><span class="id" type="lemma">mem_rend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="notation">(</span><a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a><span class="id" type="notation">).1</span> -&gt; <a class="idref" href="Adlibssr.btree.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> <span class="id" type="var">a</span> =&gt; [//=|/= <span class="id" type="var">y</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>] <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">IHr</span> <span class="id" type="var">y</span>) =&gt; {<span class="id" type="var">IHl</span> <span class="id" type="var">IHr</span> <span class="id" type="var">a</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tr</span> =&gt; [//= ? <span class="id" type="var">Hin</span> | <span class="id" type="var">z</span> <span class="id" type="var">t</span> <span class="id" type="var">tr</span> <span class="id" type="var">H</span> <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span> <span class="id" type="lemma">orbCA</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>; <span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> (<span class="id" type="var">t</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">z</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span>) <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span>; <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">or3P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Hin</span>; <span class="id" type="tactic">rewrite</span>/= <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a> -<span class="id" type="lemma">orbA</span> =&gt; /<span class="id" type="lemma">or3P</span> [/<span class="id" type="lemma">eqP</span>&lt;- | <span class="id" type="var">Hin</span> | <span class="id" type="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or32</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <span class="id" type="constructor">Or33</span>, <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="rem_root_l"><span class="id" type="definition">rem_root_l</span></a> <span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">node</span>, <span class="id" type="var">tr'</span>) := <a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">tr</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr'"><span class="id" type="variable">tr'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="rem_root_r"><span class="id" type="definition">rem_root_r</span></a> <span class="id" type="var">t</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="var">is</span> <span class="id" type="var">tl</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <span class="id" type="var">x</span> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">tl'</span>, <span class="id" type="var">node</span>) := <a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tl</span> <span class="id" type="var">x</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#tl'"><span class="id" type="variable">tl'</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <span class="id" type="var">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rem_root_l_revtree"><span class="id" type="lemma">rem_root_l_revtree</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rem_root_l"><span class="id" type="definition">rem_root_l</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> (<a class="idref" href="Adlibssr.btree.html#rem_root_r"><span class="id" type="definition">rem_root_r</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span>: <span class="id" type="var">t</span> =&gt; [//=|/= <span class="id" type="var">y</span> <span class="id" type="var">tl</span> <span class="id" type="var">IHl</span> <span class="id" type="var">tr</span> <span class="id" type="var">IHr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#lend_remove_revtree"><span class="id" type="lemma">lend_remove_revtree</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tl</span> <span class="id" type="var">y</span>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="rem_root_r_revtree"><span class="id" type="lemma">rem_root_r_revtree</span></a> <span class="id" type="var">t</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#rem_root_r"><span class="id" type="definition">rem_root_r</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> (<a class="idref" href="Adlibssr.btree.html#rem_root_l"><span class="id" type="definition">rem_root_l</span></a> <a class="idref" href="Adlibssr.btree.html#t"><span class="id" type="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -{2}[<span class="id" type="var">t</span>]<a class="idref" href="Adlibssr.btree.html#revtree_idempotent"><span class="id" type="lemma">revtree_idempotent</span></a> <a class="idref" href="Adlibssr.btree.html#rem_root_l_revtree"><span class="id" type="lemma">rem_root_l_revtree</span></a> <a class="idref" href="Adlibssr.btree.html#revtree_idempotent"><span class="id" type="lemma">revtree_idempotent</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="lend_merge"><span class="id" type="definition">lend_merge</span></a> <span class="id" type="var">a</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a> <span class="id" type="var">is</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">node</span>, <span class="id" type="var">tr'</span>) := <a class="idref" href="Adlibssr.btree.html#lend_remove"><span class="id" type="definition">lend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr'"><span class="id" type="variable">tr'</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="rend_merge"><span class="id" type="definition">rend_merge</span></a> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span> <span class="id" type="var">a</span>: <a class="idref" href="Adlibssr.btree.html#btree"><span class="id" type="inductive">btree</span></a> <a class="idref" href="Adlibssr.btree.html#EqBtree.T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <span class="id" type="var">is</span> <a class="idref" href="Adlibssr.btree.html#::'#'"><span class="id" type="notation">#</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">tl'</span>, <span class="id" type="var">node</span>) := <a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#tl'"><span class="id" type="variable">tl'</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">-&lt;</span></a> <a class="idref" href="Adlibssr.btree.html#node"><span class="id" type="variable">node</span></a> <a class="idref" href="Adlibssr.btree.html#::x_'-<'_x_'>-'_x"><span class="id" type="notation">&gt;-</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="lend_merge_revtree"><span class="id" type="lemma">lend_merge_revtree</span></a> <span class="id" type="var">a</span> <span class="id" type="var">tl</span> <span class="id" type="var">tr</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Adlibssr.btree.html#lend_merge"><span class="id" type="definition">lend_merge</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a> (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a>) (<a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Adlibssr.btree.html#revtree"><span class="id" type="definition">revtree</span></a> (<a class="idref" href="Adlibssr.btree.html#rend_merge"><span class="id" type="definition">rend_merge</span></a> <a class="idref" href="Adlibssr.btree.html#tr"><span class="id" type="variable">tr</span></a> <a class="idref" href="Adlibssr.btree.html#tl"><span class="id" type="variable">tl</span></a> <a class="idref" href="Adlibssr.btree.html#a"><span class="id" type="variable">a</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">tr</span> =&gt; [//=| <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">tr</span> /=].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Adlibssr.btree.html#lend_remove_revtree"><span class="id" type="lemma">lend_remove_revtree</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Adlibssr.btree.html#rend_remove"><span class="id" type="definition">rend_remove</span></a> <span class="id" type="var">tr</span> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span> =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">tr</span> <span class="id" type="var">Heqp</span> =&gt; [] //=.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Adlibssr.btree.html#EqBtree"><span class="id" type="section">EqBtree</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="inE"><span class="id" type="definition">inE</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Adlibssr.btree.html#mem_bnode1"><span class="id" type="lemma">mem_bnode1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Adlibssr.btree.html#in_bnode"><span class="id" type="lemma">in_bnode</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <span class="id" type="definition">inE</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>